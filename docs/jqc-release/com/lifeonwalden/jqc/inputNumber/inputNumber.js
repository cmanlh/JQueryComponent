"use strict";!function(l){$JqcLoader.importComponents("com.lifeonwalden.jqc",["baseElement","valHooks","format","uniqueKey"]).execute(function(){function s(t){t.processing=!0;var e="",i=t.input.value.length;if(0<i){for(var n=t.input.selectionStart,s=0,a=0,o=!1,r=0;r<i;r++){var u=t.input.value.charCodeAt(r);if(47<u&&u<58){if(o){if(!(a<t.options.decimals))break;a++}e=e.concat(t.input.value.charAt(r)),r<n&&s++}else if(46==u||12290==u||65294==u){if(o)break;e=e.concat("."),o=!0,r<n&&s++}else if(65295<u&&u<65306){if(o){if(!(a<t.options.decimals))break;a++}e=e.concat(String.fromCharCode(u-65248)),r<n&&s++}else 0!=r||45!=u&&65293!=u||(e=e.concat("-"),r<n&&s++)}t.formatted=t.input.value=l.jqcFormat.number(e,{decimals:t.options.decimals,toRound:!1});var c=e.indexOf(".")==s?t.formatted.indexOf("."):function(t,e){for(var i=e,n=0,s=0;s<e;n++)44==t.charCodeAt(n)?i++:s++;return i}(t.formatted,s);t.input.setSelectionRange(c,c),t.currentVal=e}else t.currentVal=t.formatted=t.input.value="";t.processing=!1,t.inputting=!1}function a(t){var e=t.attr("suffix");if(e&&0!=e.length){var i=t.attr("suffix-size")||parseInt(t.css("font-size")),n=t.attr("suffix-color")||t.css("color"),s=t.attr("suffix-weight")||t.css("font-weight"),a=t.attr("suffix-family")||t.css("font-family"),o=document.createElement("canvas");o.width=i*e.length+10,o.height=i;var r=o.getContext("2d");r.fillStyle=n,r.font=s+" "+i+"px "+a,r.textBaseline="top",r.fillText(e,5,0);var u=o.toDataURL("image/png",1);t.css({"background-image":"url("+u+")","background-size":"auto","background-position":"right center","background-repeat":"no-repeat","padding-right":o.width,"box-sizing":"border-box"})}}l.jqcInputNumber=function(t){0<arguments.length&&l.jqcBaseElement.apply(this,arguments),this.options=l.extend(!0,{},{element:null,decimals:0},t),this.el=this.options.element,this.input=this.el.get(0),this.typeName="jqcInputNumber",this.elementId="jqc".concat(l.jqcUniqueKey.fetchIntradayKey()),this.el.attr(l.jqcBaseElement.JQC_ELEMENT_TYPE,this.typeName),this.el.attr(l.jqcBaseElement.JQC_ELEMENT_ID,this.elementId),l.jqcValHooksCtrl.addElement(this),this.currentVal="",this.formatted="",this.inputting=!1,this.processing=!1;var e=this,i=null,n=!1;e.el.keyup(function(t){switch(16==t.keyCode&&(i&&clearTimeout(i),n=!0,i=setTimeout(function(){n=!1,i=null},10)),t.keyCode){case l.ui.keyCode.LEFT:case l.ui.keyCode.RIGHT:return;case l.ui.keyCode.DELETE:case l.ui.keyCode.BACKSPACE:-1!=e.formatted.indexOf(".")&&-1==e.input.value.indexOf(".")&&(e.input.value=e.input.value.substr(0,e.input.selectionStart))}e.formatted!=e.input.value&&(e.processing?t.preventDefault():(e.inputting||(e.inputting=!0),s(e)))}),e.el.on("paste",function(t){setTimeout(function(){s(e)},10)}),e.el.on("input",function(t){n&&s(e)}),this.el.attr("suffix")&&(Object.defineProperty(this.input,"disabled",{get:function(){return void 0!==this._disabled&&this._disabled},set:function(t){(this._disabled=t)?this.setAttribute("disabled",""):this.removeAttribute("disabled"),a(e.el)}}),a(this.el))},l.jqcInputNumber.prototype=new l.jqcBaseElement,l.jqcInputNumber.prototype.constructor=l.jqcInputNumber,l.jqcInputNumber.prototype.updateCurrentVal=function(t){if(null==t||null==t||0==t.length)this.currentVal=this.formatted="";else{this.formatted=l.jqcFormat.number(t,{decimals:this.options.decimals,toRound:!1});var e=t.indexOf(".");0==this.options.decimals?this.currentVal=-1==e?t:t.substr(0,e):this.currentVal=-1==e?t:t.substr(0,e+this.options.decimals+1)}return this.formatted}})}(jQuery);
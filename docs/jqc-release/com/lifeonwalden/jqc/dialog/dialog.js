"use strict";!function(c){$JqcLoader.importComponents("com.lifeonwalden.jqc",["baseElement","lang","draggable","resizeable","zindex","blocker"]).importCss($JqcLoader.getCmpParentURL("com.lifeonwalden.jqc","dialog").concat("css/dialog.css")).execute(function(){function r(o){var n=this;return n.mgr=o.mgr,n.ui=c('<div class="jqcDialogMinimizeBar" style="display:none;" title="'.concat(c.jqcLang.DIALOG_MAXIMUN).concat('">placeHolder</div>')),n.ui.css("z-index",c.jqcZindex.popup+99),n.ui.on("click",function(o){n.hide(),n.index!=n.mgr.onboardLength?(n.mgr.onboard[n.index-1]=!1,n.mgr.reLayout()):n.mgr.onboard.pop(),n.mgr.idle.push(n),n.dialog.container.show(),n.dialog.minimizeBar=null,n.dialog=null,n.mgr.onboardLength--}),c("body").append(n.ui),n}function o(){var i=this,o=new r({mgr:i});return i.idle=[],i.onboard=[],i.onboardLength=0,i.idle.push(o),i.barWidth=o.ui.outerWidth(),i.barHeight=o.ui.outerHeight(),i.maxColumn=Math.floor(window.innerWidth/(i.barWidth+5)),c(window).on("resize",function(o){var n=Math.floor(window.innerWidth/(i.barWidth+5));n!=i.maxColumn&&(i.maxColumn=n,i.reLayout())}),i}r.prototype.bindDialog=function(o){var n=this;n.dialog=o,(n.dialog.minimizeBar=n).ui.html(o.options.title)},r.prototype.show=function(){this.ui.show()},r.prototype.blink=function(){var o=this;1!=o.isBlink&&(o.isBlink=!0,function o(n,i,e){if(6==i)return void(n.isBlink=!1);n.ui.css("box-shadow",e[i%2]);setTimeout(function(){o(n,i+1,e)},500)}(o,0,["0 0 15px red",o.ui.css("box-shadow")]))},r.prototype.reLayout=function(o,n){this.ui.css("bottom",o),this.ui.css("left",n)},r.prototype.hide=function(){this.ui.hide()},o.prototype.bindDialog=function(o){var n=this,i=n.idle.pop();i||(i=new r({mgr:n})),n.onboardLength++,i.index=n.onboardLength,n.onboard[i.index-1]=i;var e=Math.floor((n.onboardLength-1)/n.maxColumn),t=Math.floor(n.onboardLength%n.maxColumn),a=0==t?n.maxColumn:t;i.reLayout(e*(n.barHeight+5),(a-1)*(n.barWidth+5)),i.bindDialog(o),i.show()},o.prototype.reLayout=function(){var t=this,a=0,r=[];t.onboard.forEach(function(o){if(o){var n=Math.floor(a/t.maxColumn),i=Math.floor((a+1)%t.maxColumn),e=0==i?t.maxColumn:i;o.index=a+1,r.push(o),o.reLayout(n*(t.barHeight+5),(e-1)*(t.barWidth+5)),a++}}),t.onboard=r};var t={modal:!0,position:"auto",width:680,content:null,title:null,beforeClose:null,afterClose:null,beforeOpen:null,afterOpen:null},a=[],n=new o;c.jqcDialog=function(o){var n,i,e;(n=a.pop())?n.options=c.extend(!0,{},t,o):(0<arguments.length&&c.jqcBaseElement.apply(this,arguments),(n=this).options=c.extend(!0,{},t,o),(e=n).title=c('<span class="jqcDialogTitle">'),e.closeBtn=c('<span class="jqcDialogCloseBtn" title="'.concat(c.jqcLang.DIALOG_CLOSE).concat('">')),e.minimizeBtn=c('<span class="jqcDialogMinimizeBtn" title="'.concat(c.jqcLang.DIALOG_MINIMIZE).concat('">')),e.titleBar=c('<div class="jqcDialogTitleBar" title="'.concat(c.jqcLang.DIALOG_MOVE).concat('">')),e.titleBar.append(e.title).append(e.closeBtn).append(e.minimizeBtn),e.content=c('<div class="jqcDialogContent">'),e.resizeHandleE=c('<div class="jqcDialogResizeHandleE" title="resize">'),e.container=c('<div class="jqcDialogContainer" style="display:none;">'),e.container.append(e.titleBar).append(e.content).append(e.resizeHandleE).appendTo("body"),(i=n).closeBtn.on("mousedown click",function(o){i.close()}),i.minimizeBtn.on("mousedown click",function(o){i.minimize()}),i.titleBar.on("mousedown click",function(o){o.target.className.indexOf("jqcDialogTitleBar")<0||c.jqcZindex.popupMgr.isTop(i.zindex)||(c.jqcZindex.popupMgr.returnIndex(i.zindex),i.zindex=c.jqcZindex.popupMgr.fetchIndex(),i.container.css("z-index",i.zindex))}),new c.jqcDraggable({dragHandler:i.titleBar,movableBox:i.container}),new c.jqcResizeable({dragHandler:i.resizeHandleE,resizeableBox:i.container,minWidth:i.options.width}));return function(n){n.title.html(n.options.title);var o=350;o<n.options.width&&(o=n.options.width),n.container.width(o);var i=n.options.position,e=100,t=0;if("string"==typeof i)switch(i.toUpperCase()){case"AUTO":default:t=o>window.innerWidth?0:(window.innerWidth-o)/2}else e=0<=i.top?i.top:100,t=0<=i.left?i.left:(window.innerWidth-o)/2;n.container.css("top",e),n.container.css("left",t),n.content.html(n.options.content),n.content.css("max-height",c.jqcDialog.getContainerMaxHeight()+5),n.container.outerHeight()>window.innerHeight&&(n.heightOverflow=!0,n.content.height(c.jqcDialog.getContainerMaxHeight()+5)),n.options.modal&&(n.modalBox=new c.jqcBlocker,n.modalBox.addListener("click.dialog",function(o){n.minimizeBar}))}(n),n},c.jqcDialog.prototype=new c.jqcBaseElement,c.jqcDialog.prototype.constructor=c.jqcDialog,c.jqcDialog.prototype.open=function(o){var n=this;if(n.options.beforeOpen&&n.options.beforeOpen(),"auto"==this.options.position){var i=this.container.outerHeight();window.innerHeight<i+200?this.container.css("top",0):this.container.css("top",100)}n.options.modal&&n.modalBox.show(),n.zindex=c.jqcZindex.popupMgr.fetchIndex(),n.container.css("z-index",n.zindex),n.container.fadeIn(),n.options.afterOpen&&n.options.afterOpen(),c(document).on("keyup.esc",function(o){27==o.keyCode&&n.close()})},c.jqcDialog.prototype.close=function(o){var n=this;n.options.beforeClose&&n.options.beforeClose(),n.container.hide(),n.content.height(""),n.heightOverflow=!1,c.jqcZindex.popupMgr.returnIndex(n.zindex),n.options.modal&&n.modalBox.close(),a.push(n),n.options.afterClose&&n.options.afterClose(),c(document).off("keyup.esc")},c.jqcDialog.prototype.minimize=function(o){this.container.hide(),n.bindDialog(this)},c.jqcDialog.prototype.getContainer=function(o){return this.content},c.jqcDialog.getContainerMaxHeight=function(){return window.innerHeight-60}})}(jQuery);
"use strict";!function(l){$JqcLoader.importComponents("com.lifeonwalden.jqc",["baseElement","lang","draggable","resizeable","zindex","blocker"]).importCss($JqcLoader.getCmpParentURL("com.lifeonwalden.jqc","dialog").concat("css/dialog.css")).execute(function(){function r(o){var n=this;return n.mgr=o.mgr,n.ui=l('<div class="jqcDialogMinimizeBar" style="display:none;" title="'.concat(l.jqcLang.DIALOG_MAXIMUN).concat('">placeHolder</div>')),n.ui.css("z-index",l.jqcZindex.popup+99),n.ui.on("click",function(o){n.hide(),n.index!=n.mgr.onboardLength?(n.mgr.onboard[n.index-1]=!1,n.mgr.reLayout()):n.mgr.onboard.pop(),n.mgr.idle.push(n),n.dialog.container.show(),n.dialog.minimizeBar=null,n.dialog=null,n.mgr.onboardLength--}),l("body").append(n.ui),n}function o(){var i=this,o=new r({mgr:i});return i.idle=[],i.onboard=[],i.onboardLength=0,i.idle.push(o),i.barWidth=o.ui.outerWidth(),i.barHeight=o.ui.outerHeight(),i.maxColumn=Math.floor(window.innerWidth/(i.barWidth+5)),l(window).on("resize",function(o){var n=Math.floor(window.innerWidth/(i.barWidth+5));n!=i.maxColumn&&(i.maxColumn=n,i.reLayout())}),i}r.prototype.bindDialog=function(o){var n=this;n.dialog=o,(n.dialog.minimizeBar=n).ui.html(o.options.title)},r.prototype.show=function(){this.ui.show()},r.prototype.blink=function(){var o=this;1!=o.isBlink&&(o.isBlink=!0,function o(n,i,t){if(6==i)return void(n.isBlink=!1);n.ui.css("box-shadow",t[i%2]);setTimeout(function(){o(n,i+1,t)},500)}(o,0,["0 0 15px red",o.ui.css("box-shadow")]))},r.prototype.reLayout=function(o,n){this.ui.css("bottom",o),this.ui.css("left",n)},r.prototype.hide=function(){this.ui.hide()},o.prototype.bindDialog=function(o){var n=this,i=n.idle.pop();i||(i=new r({mgr:n})),n.onboardLength++,i.index=n.onboardLength,n.onboard[i.index-1]=i;var t=Math.floor((n.onboardLength-1)/n.maxColumn),e=Math.floor(n.onboardLength%n.maxColumn),a=0==e?n.maxColumn:e;i.reLayout(t*(n.barHeight+5),(a-1)*(n.barWidth+5)),i.bindDialog(o),i.show()},o.prototype.reLayout=function(){var e=this,a=0,r=[];e.onboard.forEach(function(o){if(o){var n=Math.floor(a/e.maxColumn),i=Math.floor((a+1)%e.maxColumn),t=0==i?e.maxColumn:i;o.index=a+1,r.push(o),o.reLayout(n*(e.barHeight+5),(t-1)*(e.barWidth+5)),a++}}),e.onboard=r};var e={modal:!0,position:"auto",width:680,content:null,title:null,beforeClose:null,afterClose:null,beforeOpen:null,afterOpen:null},a=[],n=new o;l.jqcDialog=function(o){var n,i,t;(n=a.pop())?n.options=l.extend(!0,{},e,o):(0<arguments.length&&l.jqcBaseElement.apply(this,arguments),(n=this).options=l.extend(!0,{},e,o),(t=n).title=l('<span class="jqcDialogTitle">'),t.closeBtn=l('<span class="jqcDialogCloseBtn" title="'.concat(l.jqcLang.DIALOG_CLOSE).concat('">')),t.minimizeBtn=l('<span class="jqcDialogMinimizeBtn" title="'.concat(l.jqcLang.DIALOG_MINIMIZE).concat('">')),t.titleBar=l('<div class="jqcDialogTitleBar" title="'.concat(l.jqcLang.DIALOG_MOVE).concat('">')),t.titleBar.append(t.title).append(t.closeBtn).append(t.minimizeBtn),t.content=l('<div class="jqcDialogContent">'),t.resizeHandleE=l('<div class="jqcDialogResizeHandleE" title="resize">'),t.container=l('<div class="jqcDialogContainer" style="display:none;">'),t.container.append(t.titleBar).append(t.content).append(t.resizeHandleE).appendTo("body"),(i=n).closeBtn.on("mousedown click",function(o){i.close()}),i.minimizeBtn.on("mousedown click",function(o){i.minimize()}),i.titleBar.on("mousedown click",function(o){o.target.className.indexOf("jqcDialogTitleBar")<0||l.jqcZindex.popupMgr.isTop(i.zindex)||(l.jqcZindex.popupMgr.returnIndex(i.zindex),i.zindex=l.jqcZindex.popupMgr.fetchIndex(),i.container.css("z-index",i.zindex))}),new l.jqcDraggable({dragHandler:i.titleBar,movableBox:i.container}),new l.jqcResizeable({dragHandler:i.resizeHandleE,resizeableBox:i.container,minWidth:i.options.width}));return function(n){n.title.html(n.options.title);var o=350;o<n.options.width&&(o=n.options.width),n.container.width(o);var i=n.options.position,t=100,e=0;if("string"==typeof i)switch(i.toUpperCase()){case"AUTO":default:e=o>window.innerWidth?0:(window.innerWidth-o)/2}else t=0<=i.top?i.top:100,e=0<=i.left?i.left:(window.innerWidth-o)/2;n.container.css("top",t),n.container.css("left",e),n.content.html(n.options.content),n.content.css("max-height",l.jqcDialog.getContainerMaxHeight()+5),n.container.outerHeight()>window.innerHeight&&(n.heightOverflow=!0,n.content.height(l.jqcDialog.getContainerMaxHeight()+5)),n.options.modal&&(n.modalBox=new l.jqcBlocker,n.modalBox.addListener("click.dialog",function(o){n.minimizeBar}))}(n),n},l.jqcDialog.prototype=new l.jqcBaseElement,l.jqcDialog.prototype.constructor=l.jqcDialog,l.jqcDialog.prototype.open=function(o){var n=this;if(n.options.beforeOpen&&n.options.beforeOpen(),"auto"==this.options.position){var i=this.container.outerHeight();window.innerHeight<i+200?this.container.css("top",0):this.container.css("top",100)}n.options.modal&&n.modalBox.show(),n.zindex=l.jqcZindex.popupMgr.fetchIndex(),n.container.css("z-index",n.zindex),n.container.fadeIn(),n.options.afterOpen&&n.options.afterOpen()},l.jqcDialog.prototype.close=function(o){var n=this;n.options.beforeClose&&n.options.beforeClose(),n.container.hide(),n.content.height(""),n.heightOverflow=!1,l.jqcZindex.popupMgr.returnIndex(n.zindex),n.options.modal&&n.modalBox.close(),a.push(n),n.options.afterClose&&n.options.afterClose()},l.jqcDialog.prototype.minimize=function(o){this.container.hide(),n.bindDialog(this)},l.jqcDialog.prototype.getContainer=function(o){return this.content},l.jqcDialog.getContainerMaxHeight=function(){return window.innerHeight-60}})}(jQuery);
"use strict";!function(i){$JqcLoader.importComponents("com.lifeonwalden.jqc",["baseElement","uniqueKey","valHooks","notification","select"]).importCss($JqcLoader.getCmpParentURL("com.lifeonwalden.jqc","tag").concat("css/tag.css")).execute(function(){var e={width:400,adapter:{value:"value",label:"label"},defaultValue:""};i.jqcTag=function(t){if(Object.assign(this,e,t),!this.el)throw new Error("jqcTag:缺少input标签");this.el.data("jqcTag",this),this.currentValue=[],this.init()},i.jqcTag.prototype.init=function(){this.el.prop({readonly:!0,hidden:!0}),this.render(),this.bindEvent();var t=this.el[0].value||this.defaultValue;this.setValue(t)},i.jqcTag.prototype.render=function(){this.container=i("<div>").addClass("jqcTag-container").css({width:this.width}),this.el.after(this.container),this.createBtn=i("<p>").addClass("jqcTag-btn").text("新建"),this.createInput=i('<input type="text">').addClass("jqcTag-input").attr("maxlength",10),this.container.append(this.createBtn,this.createInput)},i.jqcTag.prototype.bindEvent=function(){var a=this;this.createBtn.click(function(t){t.stopPropagation(),i(this).hide(),a.createInput.show().focus()}),Array.isArray(this.data)?new i.jqcSelect({el:a.createInput,data:a.data,adapter:a.adapter,onSelect:function(t){a.logginTag()}}):(this.createInput.click(function(t){t.stopPropagation()}),this.createInput.keyup(function(t){var e=i(this).val();-1<e.indexOf(";")&&i(this).val(e.replace(/\;/g,""))})),i(document).on({"click.jqcTag":function(t){a.createInput.is(":visible")&&a.logginTag()},"keyup.jqcTag":function(t){if(a.createInput.is(":visible")){if(13!=t.keyCode)return;a.logginTag()}}}),this.container.on("click","span",function(){var e=i(this).parent();a.currentValue=a.currentValue.filter(function(t){return t!==e.text()}),e.remove()})},i.jqcTag.prototype.logginTag=function(){var t=(this.createInput.val()||"").trim();this.createInput.hide().val(""),this.createBtn.show(),this.createTag(t)},i.jqcTag.prototype.createTag=function(t){if(""!==t)if(-1<this.currentValue.indexOf(t))i.jqcNotification({type:"error",title:"".concat(t,"已存在")});else{this.currentValue.push(t);var e=i("<p>").text(t).addClass("jqcTag-item"),a=i("<span>");this.createBtn.before(e),e.append(a)}},i.jqcTag.prototype.setValue=function(t){var e=this;this.currentValue=[],this.el.prop("disabled")?this.container.addClass("jqcTag-readOnly"):this.el.removeClass("jqcTag-readOnly"),this.container.find(".jqcTag-item").remove(),t.split(";").forEach(function(t){""!==t&&e.createTag(t)})},i.jqcTag.prototype.getValue=function(){return this.currentValue.join(";")}})}(jQuery);
"use strict";!function(n){$JqcLoader.importComponents("com.lifeonwalden.jqc",["baseElement","uniqueKey","pinyin"]).importCss($JqcLoader.getCmpParentURL("com.lifeonwalden.jqc","search").concat("css/search.css")).execute(function(){var t={element:null,onSelect:null,data:[],placeholder:""};n.jqcSearch=function(e){this.tabs=[],this.options=n.extend(!0,{},t,e),this.typeName="jqcSearch",this.elementId="jqc".concat(n.jqcUniqueKey.fetchIntradayKey()),this.result=[],this.index=0,this.pinyin=new n.jqcPinyin,this.options.data?this.data=function s(e,i){var n=[];e.forEach(function(e){if(e.child)n=n.concat(s(e.child,i));else{var t=i.firstAlphabet(e.label);n.push(Object.assign(e,{pinyin:t}))}});return n}(this.options.data,this.pinyin):this.data=[],this.el=this.options.element||null,this.render()},n.jqcSearch.prototype=new n.jqcBaseElement,n.jqcSearch.prototype.constructor=n.jqcSearch,n.jqcSearch.prototype.render=function(){if(!this.el)throw new Error("Element expects a jQuery object.");var s=this;this.input=n('<input type="text"/>').addClass("jqcSearch-input").attr("placeholder",s.options.placeholder).focus(function(){s.renderResultList()}).keyup(function(e){var t=e.keyCode;38===t?(s.index--,s.index=s.index<1?s.result.length:s.index,s.chooseItem()):40===t?(s.index++,s.index=s.index>s.result.length?1:s.index,s.chooseItem()):13===t?s.resultList.find(".jqcSearch-resultItem-active").trigger("click"):s.renderResultList()}),this.resultList=n("<div>").addClass("jqcSearch-resultList"),this.el.attr(n.jqcBaseElement.JQC_ELEMENT_TYPE,this.typeName).attr(n.jqcBaseElement.JQC_ELEMENT_ID,this.elementId).append(this.input).append(this.resultList).addClass("jqcSearch"),"static"===this.el.css("position")&&this.el.css("position","relative"),n(document).on("click",function(e){n(e.target).parents(".jqcSearch").length||s.resultList.hide()})},n.jqcSearch.prototype.renderResultList=function(){var i=this;this.index=0,this.resultList.empty();var t=this.input.val().trim();if(this.result=t?this.data.filter(function(e){return-1<e.label.indexOf(t)||-1<e.pinyin.indexOf(t)}):this.data||[],this.result.forEach(function(e,t){var s=n("<div>"+e.label+"</div>").addClass("jqcSearch-resultItem").click(function(){i.input.val(e.label),i.resultList.hide(),i.options.onSelect&&i.options.onSelect(e)}).mouseenter(function(){i.index=t+1,n(this).addClass("jqcSearch-resultItem-active").siblings().removeClass("jqcSearch-resultItem-active")}).mouseleave(function(){i.index=0,n(this).removeClass("jqcSearch-resultItem-active").siblings().removeClass("jqcSearch-resultItem-active")});i.resultList.append(s)}),!this.result.length){var e=n("<span>无对应选项</span>").addClass("noResult");this.resultList.append(e)}this.resultList.show()},n.jqcSearch.prototype.chooseItem=function(){this.resultList.find(".jqcSearch-resultItem").removeClass("jqcSearch-resultItem-active").eq(this.index-1).addClass("jqcSearch-resultItem-active")}})}(jQuery);
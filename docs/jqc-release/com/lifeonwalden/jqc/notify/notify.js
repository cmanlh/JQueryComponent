"use strict";!function(f){$JqcLoader.importComponents("com.lifeonwalden.jqc",["dateUtil"]).importCss($JqcLoader.getCmpParentURL("com.lifeonwalden.jqc","notify").concat("css/notify.css")).execute(function(){var i={el:"",status:"normal",data:[],position:"left",adapter:{title:"title",content:"content",time:function(){return new Date}}};f.jqcNotify=function(t){var o={};if(Object.assign(o,i.adapter,t.adapter),Object.assign(this,i,t,{adapter:o}),!this.el)throw new Error("jqcNotify: el参数非jquery对象。");this.init(),this.bindEvent()},f.jqcNotify.prototype.init=function(){this.el.addClass("jqcNotify-element"),this.badge=f("<span>").addClass("jqcNotify-badge"),this.el.append(this.badge),this.ctrBadge()},f.jqcNotify.prototype.bindEvent=function(){var o=this;this.el.click(function(t){t.stopPropagation(),"normal"==o.status?o.open():o.close()}),f(document).on("click.jqcNotify",function(){o.lock||"active"==o.status&&o.close()})},f.jqcNotify.prototype.open=function(){this.status="active",this.el.addClass("active"),this.render(),this.badge.hide()},f.jqcNotify.prototype.close=function(){var t=this;this.status="normal",this.el.removeClass("active"),this.container.remove(),this.ctrBadge(),this.onClose&&setTimeout(function(){t.onClose.call(this)},20)},f.jqcNotify.prototype.render=function(){var r=this,l=this.adapter.title,d=this.adapter.content,p=this.adapter.time,t={},o=this.el.offset();t.top=o.top+this.el.outerHeight()+8,"right"==this.position?t.left=o.left+this.el.outerWidth()-300:t.left=o.left,this.container=f("<div>").addClass("jqcNotify-container").css(t),f("body").append(this.container),this.more=f("<div>").addClass("jqcNotify-more");var i=f("<div>").addClass("jqcNotfiy-more-left").text("通知"),e=null;this.onMore&&(e=f("<div>").addClass("jqcNotfiy-more-right"),this.more.css("cursor","pointer").click(function(){r.onMore.call(r)})),this.more.append(i,e);this.data.length;if(this.tip){var s=this.tip.call(this,this.data),a=f("<span>").text(s);i.append(a)}this.container.append(this.more),this.scrollBox=f("<div>").addClass("jqcNotify-scrollBox"),this.scroller=f("<div>").addClass("jqcNotify-scroller");var h=f("<div>").addClass("jqcNotify-items");this.container.append(this.scrollBox),this.scrollBox.append(this.scroller,h),this.data.forEach(function(t){var o=f("<div>"),i=f("<div>").addClass("jqcNotify-item-content");o.append(i);var e=f("<div>").addClass("jqcNotify-item-title"),s=f("<p>").text(t[l]),a=f.jqcDateUtil.format(p(t),"yyyy/MM/dd HH:mm:ss"),n=f("<span>").text(a);i.append(e),e.append(s,n);var c=f("<div>").addClass("jqcNotify-item-body").text(t[d]);i.append(c),h.append(o),r.onSelect&&o.css("cursor","pointer").click(function(){r.onSelect.call(r,t)})}),setTimeout(function(){var c=h[0].scrollHeight;if(450<c){var t=(45e3/c).toFixed(4)+"%";r.scroller.css({height:t,top:0}).show(),h.scroll(function(t){var o=(f(this).scrollTop()/c*100).toFixed(4)+"%";r.scroller.css({top:o})})}r.scroller.mousedown(function(t){f(this).addClass("hover");var s=f(this).position().top,a=f(this).height(),n=t.pageY;r.lock=!0,f(document).on("mousemove.jqcNotify",function(t){var o=t.pageY-n,i=s+o;i<0&&(i=0),450<i+a&&(i=450-a),r.scroller.css({top:i});var e=i*c/450;h.scrollTop(e)}),f(document).on("mouseup.jqcNotify",function(t){t.stopPropagation(),r.scroller.removeClass("hover"),f(this).off("mousemove.jqcNotify"),f(this).off("mouseup.jqcNotify"),setTimeout(function(){r.lock=!1},20)})}),r.onOpen&&r.onOpen.call(r)},10),this.container.click(function(t){t.stopPropagation()})},f.jqcNotify.prototype.ctrBadge=function(){var t=this.data.length;t?(t=99<t?"99+":t,this.badge.text(t).show()):this.badge.hide()}})}(jQuery);